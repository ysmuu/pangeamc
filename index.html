document.getElementById('suggestionForm').addEventListener('submit', function(event) {
    event.preventDefault();

    const username = document.getElementById('username').value;
    const suggestion = document.getElementById('suggestion').value;

    const encodedWebhook = 'aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTI5NjE5Nzg4NTI2MzYxMzk5Mi8yZG9QZm5IWnJZRVBuUlFhRTM0SEhobUUwbzlUNUhCZ1NycUN6M2xGZkF4cGpKX2VLakRzT1lBUW9SV3Fpb3o4QkYxWQ==';
    const webhookURL = atob(encodedWebhook); 

    // Create the embed payload
    const payload = {
        embeds: [{
            title: "New Minecraft Server Suggestion",
            description: `A new suggestion has been submitted by **${username}**`,
            color: 5814783,
            fields: [
                {
                    name: "User",
                    value: username,
                    inline: true
                },
                {
                    name: "Suggestion",
                    value: suggestion,
                    inline: false
                }
            ],
            footer: {
                text: "PangeaMC stupid suggestion bot",
                icon_url: "https://i.imgur.com/Y1dPLe5.png"
            },
            timestamp: new Date().toISOString()
        }]
    };

    // Send the suggestion to the server
    fetch('/suggest', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ username, suggestion })
    })
    .then(response => {
        if (response.ok) {
            alert('Thank you for your suggestion!');
            document.getElementById('suggestionForm').reset();
        } else {
            alert('There was an issue submitting your suggestion. Please try again later.');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('There was an error connecting to the server.');
    });
});
